{"filter":false,"title":"app.py","tooltip":"/app.py","undoManager":{"mark":34,"position":34,"stack":[[{"start":{"row":0,"column":0},"end":{"row":47,"column":0},"action":"remove","lines":["import requests","import json","import boto3","from datetime import datetime","","def get_weather(city):","    api_key = 'bb97533805fced5bb8e6af83e94dbee8'  ","    base_url = f\"http://api.openweathermap.org/data/2.5/weather?q={city}&appid={api_key}\"","    response = requests.get(base_url)","    data = response.json()","    ","    if response.status_code == 200:","        main = data['main']","        wind = data['wind']","        weather_desc = data['weather'][0]['description']","        ","        weather_info = {","            'Temperature': main['temp'],","            'Humidity': main['humidity'],","            'Pressure': main['pressure'],","            'Weather Description': weather_desc,","            'Wind Speed': wind['speed'],","            'Timestamp': datetime.utcnow().isoformat()","        }","        ","        # Speichern der Wetterdaten in AWS S3","        save_weather_to_s3(city, weather_info)","        ","        return weather_info","    else:","        return {\"Error\": \"City not found\"}","","def save_weather_to_s3(city, weather_info):","    s3 = boto3.client('s3')","    bucket_name = 'weatherforecast' ","    file_name = f\"weather_data/{city}_{weather_info['Timestamp']}.json\"","    ","    s3.put_object(","        Bucket=bucket_name,","        Key=file_name,","        Body=json.dumps(weather_info),","        ContentType='application/json'","    )","","if __name__ == \"__main__\":","    city = input(\"Enter city name: \")","    print(get_weather(city))",""],"id":67},{"start":{"row":0,"column":0},"end":{"row":59,"column":0},"action":"insert","lines":["import requests","import json","import boto3","from datetime import datetime","from flask import Flask, request, render_template, jsonify","","app = Flask(__name__)","","def get_weather(city):","    api_key = 'bb97533805fced5bb8e6af83e94dbee8'  ","    base_url = f\"http://api.openweathermap.org/data/2.5/weather?q={city}&appid={api_key}\"","    response = requests.get(base_url)","    data = response.json()","    ","    if response.status_code == 200:","        main = data['main']","        wind = data['wind']","        weather_desc = data['weather'][0]['description']","        ","        weather_info = {","            'Temperature': main['temp'],","            'Humidity': main['humidity'],","            'Pressure': main['pressure'],","            'Weather Description': weather_desc,","            'Wind Speed': wind['speed'],","            'Timestamp': datetime.utcnow().isoformat()","        }","        ","        # Speichern der Wetterdaten in AWS S3","        save_weather_to_s3(city, weather_info)","        ","        return weather_info","    else:","        return {\"Error\": \"City not found\"}","","def save_weather_to_s3(city, weather_info):","    s3 = boto3.client('s3')","    bucket_name = 'weatherforecast' ","    file_name = f\"weather_data/{city}_{weather_info['Timestamp']}.json\"","    ","    s3.put_object(","        Bucket=bucket_name,","        Key=file_name,","        Body=json.dumps(weather_info),","        ContentType='application/json'","    )","","@app.route('/')","def index():","    return render_template('index.html')","","@app.route('/weather', methods=['POST'])","def weather():","    city = request.form['city']","    weather_info = get_weather(city)","    return jsonify(weather_info)","","if __name__ == \"__main__\":","    app.run(debug=True)",""]}],[{"start":{"row":4,"column":58},"end":{"row":5,"column":0},"action":"insert","lines":["",""],"id":68}],[{"start":{"row":5,"column":0},"end":{"row":8,"column":0},"action":"insert","lines":["from flask_cors import CORS","app = Flask(__name__)","CORS(app)",""],"id":69}],[{"start":{"row":6,"column":0},"end":{"row":7,"column":0},"action":"insert","lines":["",""],"id":70}],[{"start":{"row":9,"column":0},"end":{"row":11,"column":21},"action":"remove","lines":["","","app = Flask(__name__)"],"id":71}],[{"start":{"row":10,"column":0},"end":{"row":10,"column":1},"action":"insert","lines":["@"],"id":72}],[{"start":{"row":10,"column":1},"end":{"row":10,"column":2},"action":"insert","lines":["a"],"id":73},{"start":{"row":10,"column":2},"end":{"row":10,"column":3},"action":"insert","lines":["p"]},{"start":{"row":10,"column":3},"end":{"row":10,"column":4},"action":"insert","lines":["p"]}],[{"start":{"row":10,"column":4},"end":{"row":10,"column":5},"action":"insert","lines":["."],"id":74},{"start":{"row":10,"column":5},"end":{"row":10,"column":6},"action":"insert","lines":["r"]},{"start":{"row":10,"column":6},"end":{"row":10,"column":7},"action":"insert","lines":["o"]},{"start":{"row":10,"column":7},"end":{"row":10,"column":8},"action":"insert","lines":["u"]},{"start":{"row":10,"column":8},"end":{"row":10,"column":9},"action":"insert","lines":["t"]},{"start":{"row":10,"column":9},"end":{"row":10,"column":10},"action":"insert","lines":["e"]}],[{"start":{"row":10,"column":10},"end":{"row":10,"column":12},"action":"insert","lines":["()"],"id":75}],[{"start":{"row":10,"column":11},"end":{"row":10,"column":12},"action":"insert","lines":["`"],"id":76},{"start":{"row":10,"column":11},"end":{"row":10,"column":12},"action":"remove","lines":["`"]}],[{"start":{"row":10,"column":11},"end":{"row":10,"column":12},"action":"insert","lines":["#"],"id":77}],[{"start":{"row":10,"column":11},"end":{"row":10,"column":12},"action":"remove","lines":["#"],"id":78}],[{"start":{"row":10,"column":11},"end":{"row":10,"column":13},"action":"insert","lines":["''"],"id":79}],[{"start":{"row":10,"column":12},"end":{"row":10,"column":13},"action":"insert","lines":["/"],"id":80},{"start":{"row":10,"column":13},"end":{"row":10,"column":14},"action":"insert","lines":["w"]},{"start":{"row":10,"column":14},"end":{"row":10,"column":15},"action":"insert","lines":["e"]},{"start":{"row":10,"column":15},"end":{"row":10,"column":16},"action":"insert","lines":["a"]},{"start":{"row":10,"column":16},"end":{"row":10,"column":17},"action":"insert","lines":["t"]}],[{"start":{"row":10,"column":17},"end":{"row":10,"column":18},"action":"insert","lines":["h"],"id":81},{"start":{"row":10,"column":18},"end":{"row":10,"column":19},"action":"insert","lines":["e"]},{"start":{"row":10,"column":19},"end":{"row":10,"column":20},"action":"insert","lines":["r"]}],[{"start":{"row":10,"column":21},"end":{"row":10,"column":22},"action":"insert","lines":[","],"id":82}],[{"start":{"row":10,"column":22},"end":{"row":10,"column":23},"action":"insert","lines":[" "],"id":83},{"start":{"row":10,"column":23},"end":{"row":10,"column":24},"action":"insert","lines":["m"]},{"start":{"row":10,"column":24},"end":{"row":10,"column":25},"action":"insert","lines":["e"]},{"start":{"row":10,"column":25},"end":{"row":10,"column":26},"action":"insert","lines":["t"]},{"start":{"row":10,"column":26},"end":{"row":10,"column":27},"action":"insert","lines":["h"]},{"start":{"row":10,"column":27},"end":{"row":10,"column":28},"action":"insert","lines":["o"]},{"start":{"row":10,"column":28},"end":{"row":10,"column":29},"action":"insert","lines":["d"]}],[{"start":{"row":10,"column":29},"end":{"row":10,"column":30},"action":"insert","lines":["s"],"id":84}],[{"start":{"row":10,"column":30},"end":{"row":10,"column":31},"action":"insert","lines":["="],"id":85}],[{"start":{"row":10,"column":31},"end":{"row":10,"column":33},"action":"insert","lines":["[]"],"id":86}],[{"start":{"row":10,"column":32},"end":{"row":10,"column":34},"action":"insert","lines":["''"],"id":87}],[{"start":{"row":10,"column":33},"end":{"row":10,"column":34},"action":"insert","lines":["G"],"id":88},{"start":{"row":10,"column":34},"end":{"row":10,"column":35},"action":"insert","lines":["E"]},{"start":{"row":10,"column":35},"end":{"row":10,"column":36},"action":"insert","lines":["T"]}],[{"start":{"row":49,"column":0},"end":{"row":49,"column":26},"action":"insert","lines":["# Route f√ºr die Startseite"],"id":89}],[{"start":{"row":48,"column":5},"end":{"row":49,"column":0},"action":"insert","lines":["",""],"id":90},{"start":{"row":49,"column":0},"end":{"row":49,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":10,"column":0},"end":{"row":10,"column":39},"action":"remove","lines":["@app.route('/weather', methods=['GET'])"],"id":91}],[{"start":{"row":5,"column":27},"end":{"row":6,"column":0},"action":"insert","lines":["",""],"id":93}],[{"start":{"row":6,"column":0},"end":{"row":6,"column":26},"action":"insert","lines":["from config import API_KEY"],"id":94}],[{"start":{"row":13,"column":4},"end":{"row":13,"column":49},"action":"remove","lines":["api_key = 'bb97533805fced5bb8e6af83e94dbee8' "],"id":95},{"start":{"row":13,"column":0},"end":{"row":13,"column":4},"action":"remove","lines":["    "]},{"start":{"row":12,"column":22},"end":{"row":13,"column":1},"action":"remove","lines":[""," "]}],[{"start":{"row":13,"column":4},"end":{"row":13,"column":89},"action":"remove","lines":["base_url = f\"http://api.openweathermap.org/data/2.5/weather?q={city}&appid={api_key}\""],"id":96},{"start":{"row":13,"column":4},"end":{"row":13,"column":102},"action":"insert","lines":["base_url = f\"http://api.openweathermap.org/data/2.5/weather?q={city}&appid={API_KEY}&units=metric\""]}],[{"start":{"row":62,"column":4},"end":{"row":62,"column":23},"action":"remove","lines":["app.run(debug=True)"],"id":97},{"start":{"row":62,"column":4},"end":{"row":62,"column":50},"action":"insert","lines":["app.run(debug=True, host='0.0.0.0', port=8080)"]}],[{"start":{"row":48,"column":5},"end":{"row":49,"column":0},"action":"insert","lines":["",""],"id":98},{"start":{"row":49,"column":0},"end":{"row":49,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":49,"column":4},"end":{"row":51,"column":56},"action":"insert","lines":["print(f\"Successfully saved weather data to {file_name}\")","    except Exception as e:","        print(f\"Failed to save weather data to S3: {e}\")"],"id":99}],[{"start":{"row":50,"column":0},"end":{"row":50,"column":4},"action":"remove","lines":["    "],"id":100}],[{"start":{"row":51,"column":4},"end":{"row":51,"column":8},"action":"remove","lines":["    "],"id":101}],[{"start":{"row":38,"column":0},"end":{"row":51,"column":52},"action":"remove","lines":["def save_weather_to_s3(city, weather_info):","    s3 = boto3.client('s3')","    bucket_name = 'weatherforecast' ","    file_name = f\"weather_data/{city}_{weather_info['Timestamp']}.json\"","    ","    s3.put_object(","        Bucket=bucket_name,","        Key=file_name,","        Body=json.dumps(weather_info),","        ContentType='application/json'","    )","    print(f\"Successfully saved weather data to {file_name}\")","except Exception as e:","    print(f\"Failed to save weather data to S3: {e}\")"],"id":102},{"start":{"row":38,"column":0},"end":{"row":51,"column":56},"action":"insert","lines":["def save_weather_to_s3(city, weather_info):","    bucket_name = 'weatherforecast'","    file_name = f\"weather_data/{city}_{weather_info['Timestamp']}.json\"","    ","    try:","        s3.put_object(","            Bucket=bucket_name,","            Key=file_name,","            Body=json.dumps(weather_info),","            ContentType='application/json'","        )","        print(f\"Successfully saved weather data to {file_name}\")","    except Exception as e:","        print(f\"Failed to save weather data to S3: {e}\")"]}]]},"ace":{"folds":[],"scrolltop":384.0000000000008,"scrollleft":0,"selection":{"start":{"row":57,"column":0},"end":{"row":57,"column":0},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":23,"state":"start","mode":"ace/mode/python"}},"timestamp":1719390857722,"hash":"a946ac7593305afa58bb7a27af52159ff0b6984c"}